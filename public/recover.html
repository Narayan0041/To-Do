<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css"
        integrity="sha512-z3gLpd7yknf1YoNbCzqRKc4qyor8gaKU1qmn+CShxbuBusANI9QpRohGBreCFkKxLhei6S9CQXFEbbKuqLg0DA=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="recover.css">
    <title>Recover || Password</title>
</head>

<body>
    <div class="container">
        <div class="recover-section">
            <div class="recover-container">
                <div>
                    <img src="../src/password.png" width="70">
                </div>
                <div>
                    <h1>Recover Your Password !!</h1>
                </div>
                <div>
                    <ul>
                        <li><span class="fa-solid fa-lock"></span><input type="password" id="password"
                                placeholder="Enter New Password "></li>
                        <h3 id="passwordError"></h3>
                    </ul>
                    <ul>
                        <li><span class="fa-solid fa-lock"></span><input type="password" id="ConformPassword"
                                placeholder="Conform Password "></li>
                        <h3 id="conformPassword"></h3>
                    </ul>
                    <div id="message-section"></div>
                    <button id="submit" onclick="recover()">Recover !!</button>
                </div>
                <div class="links">
                    <h3>You go back to <a href="login.html">Login page</a>
                    </h3>
                </div>
            </div>
        </div>
    </div>

    <script>
        function recover() {
            let password = document.getElementById("password").value.trim();
            let ConformPassword = document.getElementById("ConformPassword").value.trim();

            //for password validation
            if (password == "") {
                document.getElementById("passwordError").innerText = "password should not be empty!!";
                document.getElementById("passwordError").style.color = "red";
                document.getElementById("passwordError").style.fontSize = ".9rem";
            }

            //for conformPassword validation
            if (ConformPassword == "") {
                document.getElementById("conformPassword").innerText = "conformPassword should not be empty!!";
                document.getElementById("conformPassword").style.color = "red";
                document.getElementById("conformPassword").style.fontSize = ".9rem";
            }
            if (password == ConformPassword) {
                
                // get the value from localStorage and we check the conditions
                let recoverPasswordEmail = localStorage.getItem("Email");

                let studentsData = localStorage.getItem("studentDetail")
                let final = JSON.parse(studentsData)
                let recover = final.find(details => {
                    return details.email === recoverPasswordEmail
                 
                })
                if(recover){
                    //recover password here
                 recover.password = ConformPassword;
                 // recover password end here
                 
                 let str = JSON.stringify(final);
                localStorage.setItem("studentDetail", str)
                let success = document.getElementById("message-section");
                success.innerHTML = "Your Password has been Changed"
                success.style.backgroundColor = "green"
                success.style.margin = "1rem 1.7rem 0 3.5rem";
                success.style.height = "2.5rem"
                success.style.width = "75%";
                success.style.color = "white";
                success.style.fontSize = "1rem"
                success.style.fontWeight = "300"
                success.style.padding = ".5rem 1rem"
                success.style.borderRadius = ".2rem"
                setTimeout(() => {
                    success.style.display = "none";
                    clear();
                }, 2000)
                setTimeout(()=>{
                    window.location.href ="login.html"
                },3500)
                }
              
            }
            else {
                alert("password does not match")
            }
            return recover;

        }
        function clear() {
            let password = document.getElementById("password").value = "";
            let ConformPassword = document.getElementById("ConformPassword").value = "";
        }
    </script>
</body>

</html>